# Redmine Issue Access Control Plugin

チケットごとに閲覧可能なユーザーやグループを制限（ホワイトリスト方式）するための Redmine プラグインです。

## 機能概要

- **チケット単位のアクセス制御**: 特定のチケットに対して、閲覧・編集を許可するユーザーやグループを指定できます。
- **デフォルト非公開（Default Deny）**: プロジェクトでモジュールを有効にすると、アクセスルールが設定されていないチケットは、明示的に許可されたユーザー以外（および作成者・担当者以外）からは見えなくなります。
- **閲覧許可メンバーの表示**: チケット詳細画面に、そのチケットを閲覧できるメンバーの一覧を表示します。

## 使い方

### 1. モジュールの有効化
プロジェクト設定の「モジュール」タブで、「**チケットアクセス制御**」にチェックを入れて保存してください。
※ 有効化した時点で、アクセスルールのない既存のチケットも（権限を持たないユーザーからは）閲覧できなくなりますのでご注意ください。

### 2. 権限の設定
「管理」 > 「ロールと権限」から、以下の権限を設定してください。

- **チケットのアクセス制限設定 (`set_issue_access_control`)**:
  - チケット作成・編集画面でアクセス制御ルール（許可ユーザーの選択）を変更できる権限です。
  - 管理者やマネージャークラスのロールに付与することを推奨します。

- **制限されたチケットの全閲覧 (`view_all_restricted_issues`)**:
  - 自分アクセルルールに含まれていなくても、すべての制限付きチケットを閲覧できる権限です。
  - プロジェクト管理者や監査担当者などに付与します。

### 3. チケットのアクセス制限設定
チケットの作成または編集画面において、「**チケットのアクセス制限**」という項目が表示されます。

1. **アクセス制限の適用**:
   - リストから、このチケットの閲覧を許可したいユーザーまたはグループにチェックを入れます。
   - 検索フィルタを使用してユーザーを探すことができます。

2. **保存**:
   - チケットを保存すると、チェックを入れたユーザー（およびグループメンバー）と、チケットの作成者・担当者のみがそのチケットにアクセスできるようになります。
   - チェックを1つも入れない場合、そのチケットは「非公開」扱いとなり、権限を持つユーザー（作成者、担当者、全閲覧権限保持者）以外は見ることができません。

### 4. 閲覧許可メンバーの確認
チケット詳細画面の下部に、「**閲覧許可メンバー**」として、アクセスを許可されたユーザーやグループの名前が表示されます。

## 免責事項
このプラグインは現状有姿で提供されます。本番環境への適用の前に、十分なテストを行ってください。
